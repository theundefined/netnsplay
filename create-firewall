#!/bin/sh
(
cat <<EOF
# Generated by iptables-save v1.4.21 on Sat Jan  7 15:00:51 2017
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A FORWARD -s 192.168.0.0/16 -p tcp -m tcp --dport 1000:2000 -j REJECT --reject-with icmp-port-unreachable
-A FORWARD -s 192.168.1.0/32 -p tcp -m tcp --dport 1234 -j ACCEPT
-A FORWARD -s 192.168.1.0/24 -j ACCEPT
COMMIT
# Completed on Sat Jan  7 15:00:51 2017
# Generated by iptables-save v1.4.21 on Sat Jan  7 15:00:51 2017
*nat
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
-A POSTROUTING -s 192.168.1.100/32 -j MASQUERADE
-A POSTROUTING -s 192.168.1.0/28 -j ACCEPT
-A POSTROUTING -s 192.168.1.10/32 -j MASQUERADE
COMMIT
# Completed on Sat Jan  7 15:00:51 2017
EOF
) | ip netns exec R iptables-restore
